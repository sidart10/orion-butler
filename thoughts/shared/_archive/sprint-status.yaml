# generated: 2026-01-15
# last_updated: 2026-01-16 (Epic 1 retrospective completed, Epic 2 restructured into 2a/2b/2c)
# project: 2026-01-orion-personal-butler
# project_key: orion
# tracking_system: file-system
# story_location: thoughts/implementation-artifacts

# =============================================================================
# EPIC 2 RESTRUCTURING (2026-01-16)
# =============================================================================
# Based on adversarial spec review findings:
# - Original Epic 2 had forward dependencies on Epics 3, 4, 5, 6, 10
# - Split into 2a (no deps), 2b (needs Epic 3), 2c (needs Epic 3 + 10)
#
# DEPENDENCY CHAIN:
#   Epic 1 (Foundation) → Epic 2a (Core Agent Infra) → Epic 3 (Tool Connections)
#                                                    ↓
#   Epic 10 (Memory) ←────────────────────────────── Epic 2c (Skills)
#                    ←─────────────────── Epic 2b (Specialized Agents)
#
# CORRECTED COUNTS (from adversarial review):
#   - Agents: 26 in scope (not 31 - BMAD agents excluded from Orion)
#   - Skills: 27 total (not 40+ - 8 workflow, 6 memory, 5 research, 8 framework)
#   - Hooks: 20 total (not 34 - infrastructure files miscounted as hooks)
# =============================================================================

# STATUS DEFINITIONS:
# ==================
# Epic Status:
#   - backlog: Epic not yet started
#   - blocked: Epic waiting on dependency
#   - in-progress: Epic actively being worked on
#   - done: All stories in epic completed
#
# Story Status:
#   - backlog: Story only exists in epic file
#   - blocked: Story waiting on dependency (see blocking_reason)
#   - ready-for-dev: Story file created, dependencies met
#   - in-progress: Developer actively working on implementation
#   - review: Ready for code review
#   - done: Story completed
#
# WORKFLOW NOTES:
# ===============
# - Check blocking_reason before starting any story
# - Stories marked 'blocked' cannot proceed until blocker resolves
# - Epic 2b/2c stories will auto-unblock when Epic 3/10 completes

generated: 2026-01-15
project: 2026-01-orion-personal-butler
project_key: orion
tracking_system: file-system
story_location: thoughts/implementation-artifacts

development_status:
  # ===========================================================================
  # Epic 1: Foundation & First Chat (11 stories) - COMPLETE
  # ===========================================================================
  # No dependencies. Provides: Tauri app, Next.js frontend, SQLite, Agent Server
  # Retrospective completed: 2026-01-16
  epic-1: done
  1-1-tauri-desktop-shell: done
  1-2-nextjs-frontend-integration: done
  1-3-design-system-foundation: done
  1-4-sqlite-database-setup: done
  1-5-agent-server-process: done
  1-6-chat-message-storage: done
  1-7-claude-integration: done
  1-8-streaming-responses: done
  1-9-split-screen-layout: done
  1-10-tool-call-visualization: done
  1-11-quick-actions-keyboard-shortcuts: done
  epic-1-retrospective: done

  # ===========================================================================
  # Epic 2a: Core Agent Infrastructure (8 stories) - CAN START NOW
  # ===========================================================================
  # Dependencies: Epic 1 only
  # Provides: Butler agent, prompt templates, sub-agent spawning, tool permissions,
  #           prompt caching, hook infrastructure, session lifecycle hooks
  #
  # IMPORTANT: These stories have NO forward dependencies and can be fully
  # implemented without waiting for later epics.
  #
  # Corrected scope (from adversarial review):
  #   - 26 agent templates (BMAD agents excluded)
  #   - HookRunner infrastructure + 5 session lifecycle hooks
  #   - Tool permission system with 16 baseline tools (expanded in Epic 3)
  epic-2a: in-progress
  2a-1-butler-agent-core: ready-for-dev
  2a-2-agent-prompt-templates: ready-for-dev
  2a-2b-cc-v3-hooks-integration: ready-for-dev
  2a-3-sub-agent-spawning: ready-for-dev
  2a-4-tool-permission-system: ready-for-dev
  2a-10-prompt-caching-setup: ready-for-dev
  2a-15-hook-infrastructure-foundation: ready-for-dev
  2a-16-session-lifecycle-hooks: ready-for-dev
  epic-2a-retrospective: optional

  # ===========================================================================
  # Epic 2b: Specialized Agents & Routing Hooks (10 stories) - BLOCKED ON EPIC 3
  # ===========================================================================
  # Dependencies: Epic 2a + Epic 3 (Composio tools needed for agents to function)
  # Provides: Triage, Scheduler, Communicator, Navigator, Preference Learner agents
  #           Context injection, tool routing, validation hooks
  #
  # WHY BLOCKED: These agents need real tools (Gmail, Calendar, Slack) to do
  # anything meaningful. Without Epic 3, they would only work with mock data.
  #
  # UNBLOCKS WHEN: Epic 3 stories 3-1 through 3-7 complete (core tool connections)
  epic-2b: blocked
  epic-2b-blocking-reason: "Requires Epic 3 (Composio tool connections) - agents need real tools"
  2b-5-triage-agent-definition: blocked
  2b-6-scheduler-agent-definition: blocked
  2b-7-communicator-agent-definition: blocked
  2b-8-navigator-agent-definition: blocked
  2b-9-preference-learner-agent-definition: blocked
  2b-17-context-injection-hooks: blocked
  2b-18-tool-routing-hooks: blocked
  2b-19-validation-safety-hooks: blocked
  epic-2b-retrospective: optional

  # ===========================================================================
  # Epic 2c: Skills Infrastructure (7 stories) - BLOCKED ON EPIC 3 + EPIC 10
  # ===========================================================================
  # Dependencies: Epic 2a + Epic 3 + Epic 10 (PostgreSQL for memory skills)
  # Provides: Skill migration framework, workflow skills, memory skills, research skills
  #
  # WHY BLOCKED:
  #   - Workflow skills need Composio tools (Epic 3) to triage/draft/schedule
  #   - Memory skills need PostgreSQL archival_memory table (Epic 10)
  #   - Research skills need external search tools (Epic 3)
  #
  # UNBLOCKS WHEN: Epic 3 AND Epic 10 story 10-1 complete
  #
  # Corrected scope (from adversarial review):
  #   - 27 skills total (not 40+)
  #   - 3 functional workflow skills, 5 stub workflows (full impl in later epics)
  epic-2c: blocked
  epic-2c-blocking-reason: "Requires Epic 3 (tools) + Epic 10 (PostgreSQL memory)"
  2c-11-core-skill-migration-framework: blocked
  2c-12-workflow-skill-adaptation: blocked
  2c-13-memory-context-skills: blocked
  2c-14-research-discovery-skills: blocked
  epic-2c-retrospective: optional

  # ===========================================================================
  # Epic 3: Connect Your Tools (13 stories) - CAN START AFTER EPIC 2a
  # ===========================================================================
  # Dependencies: Epic 1 + Epic 2a (needs agent infrastructure for tool routing)
  # Provides: Composio MCP, OAuth flows for Gmail/Calendar/Slack/Drive/Exa/Firecrawl
  #
  # UNBLOCKS: Epic 2b, Epic 2c, Epic 4, Epic 5, Epic 6
  epic-3: backlog
  3-1-composio-mcp-integration: backlog
  3-2-oauth-flow-for-gmail: backlog
  3-3-oauth-flow-for-google-calendar: backlog
  3-4-re-authentication-handling: backlog
  3-5-connection-status-dashboard: backlog
  3-6-rate-limit-ux-messaging: backlog
  3-7-tool-connection-verification: backlog
  3-8-oauth-flow-for-slack: backlog
  3-9-oauth-flow-for-google-drive: backlog
  3-10-exa-search-integration: backlog
  3-11-firecrawl-web-scraping-integration: backlog
  3-12-connection-dashboard-extended: backlog
  3-13-tool-discovery-via-chat: backlog
  epic-3-retrospective: optional

  # ===========================================================================
  # Epic 4: Unified Inbox Experience (9 stories) - BLOCKED ON EPIC 3 + 2b
  # ===========================================================================
  # Dependencies: Epic 3 (Gmail tools) + Epic 2b (Triage Agent)
  epic-4: backlog
  epic-4-blocking-reason: "Requires Epic 3 (Gmail) + Epic 2b (Triage Agent)"
  4-1-email-sync-from-gmail: backlog
  4-2-unified-inbox-view: backlog
  4-3-priority-scoring-engine: backlog
  4-4-action-item-extraction: backlog
  4-5-quick-file-to-project-area: backlog
  4-6-bulk-actions: backlog
  4-7-snooze-until-later: backlog
  4-8-undo-support-for-actions: backlog
  4-9-inbox-status-indicators: backlog
  epic-4-retrospective: optional

  # ===========================================================================
  # Epic 5: Email Communication (6 stories) - BLOCKED ON EPIC 3 + 2b
  # ===========================================================================
  # Dependencies: Epic 3 (Gmail tools) + Epic 2b (Communicator Agent)
  epic-5: backlog
  epic-5-blocking-reason: "Requires Epic 3 (Gmail) + Epic 2b (Communicator Agent)"
  5-1-email-reading-view: backlog
  5-2-email-composer-in-canvas: backlog
  5-3-ai-draft-generation: backlog
  5-4-draft-review-before-send: backlog
  5-5-email-templates: backlog
  5-6-email-thread-view: backlog
  epic-5-retrospective: optional

  # ===========================================================================
  # Epic 6: Calendar Management (5 stories) - BLOCKED ON EPIC 3 + 2b
  # ===========================================================================
  # Dependencies: Epic 3 (Calendar tools) + Epic 2b (Scheduler Agent)
  epic-6: backlog
  epic-6-blocking-reason: "Requires Epic 3 (Calendar) + Epic 2b (Scheduler Agent)"
  6-1-calendar-day-week-views: backlog
  6-2-create-events-via-chat: backlog
  6-3-mutual-availability-finder: backlog
  6-4-focus-time-blocking: backlog
  6-5-meeting-prep-context: backlog
  epic-6-retrospective: optional

  # ===========================================================================
  # Epic 7: Contact & Relationship Management (7 stories)
  # ===========================================================================
  # Dependencies: Epic 1 (SQLite), Epic 3 (Gmail for auto-enrichment)
  epic-7: backlog
  7-1-contact-database-schema: backlog
  7-2-contact-crud-operations: backlog
  7-3-semantic-contact-search: backlog
  7-4-interaction-history: backlog
  7-5-auto-enrichment-from-signatures: backlog
  7-6-auto-create-contacts-from-email: backlog
  7-7-organization-linking: backlog
  epic-7-retrospective: optional

  # ===========================================================================
  # Epic 8: Projects & Tasks - PARA (6 stories)
  # ===========================================================================
  # Dependencies: Epic 1 (SQLite)
  epic-8: backlog
  8-1-project-database-schema: backlog
  8-2-project-crud-operations: backlog
  8-3-task-management: backlog
  8-4-due-date-reminders: backlog
  8-5-email-to-task-extraction: backlog
  8-6-project-stakeholders: backlog
  epic-8-retrospective: optional

  # ===========================================================================
  # Epic 9: Areas & Archive - PARA (6 stories) - BLOCKED ON EPIC 2b
  # ===========================================================================
  # Dependencies: Epic 1 + Epic 2b (Navigator Agent for PARA search)
  epic-9: backlog
  epic-9-blocking-reason: "Requires Epic 2b (Navigator Agent)"
  9-1-area-crud-operations: backlog
  9-2-area-goals-and-standards: backlog
  9-3-area-specific-triage-preferences: backlog
  9-4-archive-search: backlog
  9-5-archive-restore: backlog
  9-6-archive-with-context: backlog
  epic-9-retrospective: optional

  # ===========================================================================
  # Epic 10: Memory & Recall System (7 stories) - CAN START AFTER EPIC 1
  # ===========================================================================
  # Dependencies: Epic 1 only (Foundation provides base for PostgreSQL setup)
  # Provides: PostgreSQL archival_memory, preference storage, memory injection
  #
  # IMPORTANT: Story 10-1 UNBLOCKS Epic 2c (memory skills need this table)
  # Consider starting 10-1 early to parallelize with Epic 2a
  epic-10: backlog
  10-1-postgresql-shared-memory-setup: backlog
  10-2-preference-storage: backlog
  10-3-decision-recall: backlog
  10-4-memory-injection-in-prompts: backlog
  10-5-per-contact-memory-view: backlog
  10-6-communication-templates-storage: backlog
  10-7-learned-preferences-storage: backlog
  epic-10-retrospective: optional

  # ===========================================================================
  # Epic 11: Dynamic AI Canvas - json-render (8 stories)
  # ===========================================================================
  # Dependencies: Epic 1 (Foundation)
  epic-11: backlog
  11-1-json-render-integration: backlog
  11-2-component-catalog: backlog
  11-3-streaming-ui-support: backlog
  11-4-action-system: backlog
  11-5-data-binding: backlog
  11-6-tiptap-wysiwyg-editor: backlog
  11-7-document-import-export: backlog
  11-8-document-auto-save: backlog
  epic-11-retrospective: optional

  # ===========================================================================
  # Epic 12: Onboarding & First Run (6 stories)
  # ===========================================================================
  # Dependencies: Epic 3 (tool connections for setup), Epic 4 (first triage)
  epic-12: backlog
  epic-12-blocking-reason: "Requires Epic 3 + Epic 4 for first-run experience"
  12-1-onboarding-wizard-framework: backlog
  12-2-api-key-entry: backlog
  12-3-tool-connection-during-setup: backlog
  12-4-area-selection: backlog
  12-5-first-triage-preview: backlog
  12-6-setup-completion: backlog
  epic-12-retrospective: optional

  # ===========================================================================
  # Epic 13: Billing & Monetization (5 stories)
  # ===========================================================================
  # Dependencies: Can start anytime, but makes sense after core features
  epic-13: backlog
  13-1-stripe-integration: backlog
  13-2-free-tier-implementation: backlog
  13-3-pro-tier-subscription: backlog
  13-4-usage-metering: backlog
  13-5-subscription-management: backlog
  epic-13-retrospective: optional

  # ===========================================================================
  # Epic 14: Observability & Quality (6 stories)
  # ===========================================================================
  # Dependencies: Can start anytime
  epic-14: backlog
  14-1-braintrust-tracing: backlog
  14-2-langfuse-prompt-management: backlog
  14-3-graceful-degradation: backlog
  14-4-crash-monitoring: backlog
  14-5-uptime-monitoring: backlog
  14-6-critical-bug-tracking: backlog
  epic-14-retrospective: optional

# =============================================================================
# RECOMMENDED EXECUTION ORDER
# =============================================================================
# Phase 1: Foundation (parallel tracks)
#   Track A: Epic 1 remaining (1-11) → Epic 2a (all 8 stories)
#   Track B: Epic 10 story 10-1 (PostgreSQL setup - unblocks 2c)
#
# Phase 2: Tool Connections
#   Epic 3 stories 3-1 through 3-7 (unblocks 2b)
#
# Phase 3: Specialized Agents (parallel)
#   Track A: Epic 2b (agents + hooks)
#   Track B: Epic 2c (skills)
#   Track C: Epic 3 remaining (3-8 through 3-13)
#
# Phase 4: Feature Epics (parallel where possible)
#   Epic 4 (Inbox) + Epic 5 (Email) + Epic 6 (Calendar)
#
# Phase 5: Supporting Features
#   Epic 7 (Contacts) + Epic 8 (Projects) + Epic 9 (Areas)
#   Epic 10 remaining + Epic 11 (Canvas)
#
# Phase 6: Polish & Launch
#   Epic 12 (Onboarding) + Epic 13 (Billing) + Epic 14 (Observability)
# =============================================================================
